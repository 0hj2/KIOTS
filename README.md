# 채널 상태 정보를 활용한 대규모 언어 모델 통합형인간 행동 인식 시스템 연구
사물인터넷융복합논문지 제11권 제6호(2025.12)

# CSI 기반 LLM 통합형 인간 행동 인식 시스템

본 프로젝트는 **Wi-Fi 채널 상태 정보(Channel State Information, CSI)** 를 활용한  
**인간 행동 인식(Human Activity Recognition, HAR)** 시스템에  
**대규모 언어 모델(Large Language Model, LLM)** 을 통합하여  
사용자 행동에 기반한 **실시간 맞춤형 자연어 피드백**을 제공하는 연구용 시스템입니다.

카메라나 착용형 센서 없이 **비접촉·프라이버시 친화적**으로 행동을 인식하고,  
인식 결과를 LLM을 통해 의미적으로 해석하여 사용자에게 이해하기 쉬운 피드백을 제공합니다.

---

## 프로젝트 개요

기존 HAR 시스템은 영상 기반 또는 착용형 센서에 의존하여  
프라이버시 침해 및 사용자 부담이라는 한계를 가집니다.  
본 프로젝트는 이러한 문제를 해결하기 위해 다음과 같은 접근을 사용합니다.

- Wi-Fi CSI를 활용한 비접촉식 행동 인식
- CNN 기반 딥러닝 모델을 이용한 행동 분류
- LLM을 통한 행동 인식 결과의 자연어 해석 및 피드백 생성

---

## 주요 기능

- **CSI 기반 행동 인식**
  - 별도의 착용 장치 없이 행동 인식
  - Sitting / Standing / Walking 분류
  - CSI 히트맵 기반 CNN 모델 사용

- **LLM 기반 맞춤형 피드백**
  - 행동 상태 및 지속 시간을 반영한 프롬프트 자동 생성
  - 상황 인지형 자연어 피드백 제공
  - 피드백 길이 및 형식 제어 가능

- **실시간 웹 인터페이스**
  - 현재 행동 상태 및 누적 지속 시간 표시
  - 실시간 피드백 알림 제공

---

## 시스템 구조
<img width="450" height="300" alt="image" src="https://github.com/user-attachments/assets/317803b4-1f31-42e1-b26e-8a18a6f34c0a" />

---

## 구현 요약

- **신호 발생기**
  - OpenWrt 기반 Wi-Fi AP (IEEE 802.11n)

- **CSI 캡처기**
  - Raspberry Pi 4B + Nexmon
  - CSI 추출 및 pcap 파일 저장

- **CSI 분석 서버**
  - CSI 전처리 및 유효 서브캐리어 추출
  - 히트맵 이미지 생성
  - CNN 기반 행동 분류 (TensorFlow / Keras)
  - 행동 상태 및 지속 시간 기반 프롬프트 생성

- **LLM 연동**
  - 외부 LLM API(Gemini 등) 사용
  - 비동기 방식의 피드백 생성

- **사용자 인터페이스**
  - Flask 기반 웹 애플리케이션
  - 행동 상태 및 피드백 실시간 시각화

---

## 지원 행동 종류

- Sitting
- Standing
- Walking

---

## 연구 기여점

- CSI 기반 HAR과 LLM을 **실제 시스템 수준에서 통합**
- 행동 상태 및 지속 시간을 반영한 프롬프트 설계
- 실내 환경에서의 실측 데이터를 통한 실험적 검증
- HAR–LLM 연동 **전체 파이프라인의 실현 가능성 입증**

---

